{"version":3,"file":"index.js","mappings":"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","sources":["webpack://read-more-block/external window \"React\"","webpack://read-more-block/external window [\"wp\",\"blockEditor\"]","webpack://read-more-block/external window [\"wp\",\"blocks\"]","webpack://read-more-block/external window [\"wp\",\"components\"]","webpack://read-more-block/external window [\"wp\",\"element\"]","webpack://read-more-block/external window [\"wp\",\"i18n\"]","webpack://read-more-block/webpack/bootstrap","webpack://read-more-block/webpack/runtime/compat get default export","webpack://read-more-block/webpack/runtime/define property getters","webpack://read-more-block/webpack/runtime/hasOwnProperty shorthand","webpack://read-more-block/webpack/runtime/make namespace object","webpack://read-more-block/./src/index.js"],"sourcesContent":["module.exports = window[\"React\"];","module.exports = window[\"wp\"][\"blockEditor\"];","module.exports = window[\"wp\"][\"blocks\"];","module.exports = window[\"wp\"][\"components\"];","module.exports = window[\"wp\"][\"element\"];","module.exports = window[\"wp\"][\"i18n\"];","// The module cache\nvar __webpack_module_cache__ = {};\n\n// The require function\nfunction __webpack_require__(moduleId) {\n\t// Check if module is in cache\n\tvar cachedModule = __webpack_module_cache__[moduleId];\n\tif (cachedModule !== undefined) {\n\t\treturn cachedModule.exports;\n\t}\n\t// Create a new module (and put it into the cache)\n\tvar module = __webpack_module_cache__[moduleId] = {\n\t\t// no module.id needed\n\t\t// no module.loaded needed\n\t\texports: {}\n\t};\n\n\t// Execute the module function\n\t__webpack_modules__[moduleId](module, module.exports, __webpack_require__);\n\n\t// Return the exports of the module\n\treturn module.exports;\n}\n\n","// getDefaultExport function for compatibility with non-harmony modules\n__webpack_require__.n = (module) => {\n\tvar getter = module && module.__esModule ?\n\t\t() => (module['default']) :\n\t\t() => (module);\n\t__webpack_require__.d(getter, { a: getter });\n\treturn getter;\n};","// define getter functions for harmony exports\n__webpack_require__.d = (exports, definition) => {\n\tfor(var key in definition) {\n\t\tif(__webpack_require__.o(definition, key) && !__webpack_require__.o(exports, key)) {\n\t\t\tObject.defineProperty(exports, key, { enumerable: true, get: definition[key] });\n\t\t}\n\t}\n};","__webpack_require__.o = (obj, prop) => (Object.prototype.hasOwnProperty.call(obj, prop))","// define __esModule on exports\n__webpack_require__.r = (exports) => {\n\tif(typeof Symbol !== 'undefined' && Symbol.toStringTag) {\n\t\tObject.defineProperty(exports, Symbol.toStringTag, { value: 'Module' });\n\t}\n\tObject.defineProperty(exports, '__esModule', { value: true });\n};","import { registerBlockType } from '@wordpress/blocks';\nimport { InspectorControls, RichText } from '@wordpress/block-editor';\nimport { TextControl, PanelBody, Spinner, Button } from '@wordpress/components';\nimport { useState, useEffect } from '@wordpress/element';\nimport { __ } from '@wordpress/i18n';\n\nregisterBlockType('custom/read-more-link', {\n  title: __('Read More Link', 'text-domain'),\n  icon: 'editor-link',\n  category: 'common',\n  attributes: {\n    postId: {\n      type: 'number',\n      default: null,\n    },\n    postTitle: {\n      type: 'string',\n      default: '',\n    },\n    postUrl: {\n      type: 'string',\n      default: '',\n    },\n  },\n\n  edit: (props) => {\n    const { attributes, setAttributes } = props;\n    const { postId, postTitle, postUrl } = attributes;\n    const [searchQuery, setSearchQuery] = useState('');\n    const [posts, setPosts] = useState([]);\n    const [loading, setLoading] = useState(false);\n    const [currentPage, setCurrentPage] = useState(1);\n    const [totalPages, setTotalPages] = useState(1);\n\n    // Fetch posts based on search query\n    useEffect(() => {\n      if (searchQuery === '') return;\n\n      setLoading(true);\n      const fetchPosts = async () => {\n        try {\n          const response = await wp.apiFetch({\n            path: `/wp/v2/posts?search=${searchQuery}&page=${currentPage}&per_page=5`,\n          });\n          setPosts(response);\n          setTotalPages(Math.ceil(response.length)); // Pagination math\n          console.log(Math.ceil(response.length));\n        } catch (error) {\n          console.error('Error fetching posts:', error);\n        } finally {\n          setLoading(false);\n        }\n      };\n\n      fetchPosts();\n    }, [searchQuery, currentPage]);\n\n    // Fetch recent posts by default\n    useEffect(() => {\n      if (postId) return;\n\n      const fetchRecentPosts = async () => {\n        setLoading(true);\n        try {\n          const recentPosts = await wp.apiFetch({\n            path: '/wp/v2/posts?per_page=5',\n          });\n          setPosts(recentPosts);\n        } catch (error) {\n          console.error('Error fetching recent posts:', error);\n        } finally {\n          setLoading(false);\n        }\n      };\n\n      fetchRecentPosts();\n    }, [postId]);\n\n    const handleSearchChange = (value) => {\n      setSearchQuery(value);\n      setCurrentPage(1); // Reset page to 1 when search changes\n    };\n\n    const handlePostSelect = (post) => {\n      setAttributes({\n        postId: post.id,\n        postTitle: post.title.rendered,\n        postUrl: post.link,\n      });\n    };\n\n    return (\n      <div className=\"read-more-block\">\n        <InspectorControls>\n          <PanelBody title={__('Post Search', 'text-domain')}>\n            <TextControl\n              label={__('Search for Post', 'text-domain')}\n              value={searchQuery}\n              onChange={handleSearchChange}\n              placeholder={__('Search posts...', 'text-domain')}\n            />\n\n            {loading && <Spinner />}\n\n            {!loading && posts.length === 0 && (\n              <p>{__('No posts found.', 'text-domain')}</p>\n            )}\n\n            {!loading && posts.length > 0 && (\n              <ul>\n                {posts.map((post) => (\n                  <li key={post.id}>\n                    <Button isLink onClick={() => handlePostSelect(post)}>\n                      {post.title.rendered}\n                    </Button>\n                  </li>\n                ))}\n              </ul>\n            )}\n\n            <div>\n              {currentPage > 1 && (\n                <Button isLink onClick={() => setCurrentPage(currentPage - 1)}>\n                  {__('Previous', 'text-domain')}\n                </Button>\n              )}\n              {currentPage < totalPages && (\n                <Button isLink onClick={() => setCurrentPage(currentPage + 1)}>\n                  {__('Next', 'text-domain')}\n                </Button>\n              )}\n            </div>\n          </PanelBody>\n        </InspectorControls>\n\n        <div className=\"read-more-preview\">\n          {postId && (\n            <RichText\n              tagName=\"p\"\n              className=\"dmg-read-more\"\n              value={`Read More: ${postTitle}`}\n              onChange={(content) => setAttributes({ postTitle: content })}\n              allowedFormats={[]}\n            />\n          )}\n        </div>\n      </div>\n    );\n  },\n\n  save: (props) => {\n    const { attributes } = props;\n    const { postTitle, postUrl } = attributes;\n\n    if (!postTitle || !postUrl) {\n      return null;\n    }\n\n    return (\n      <p className=\"dmg-read-more\">\n        <a href={postUrl}>{`Read More: ${postTitle}`}</a>\n      </p>\n    );\n  },\n});\n"],"names":["registerBlockType","InspectorControls","RichText","TextControl","PanelBody","Spinner","Button","useState","useEffect","__","title","icon","category","attributes","postId","type","default","postTitle","postUrl","edit","props","setAttributes","searchQuery","setSearchQuery","posts","setPosts","loading","setLoading","currentPage","setCurrentPage","totalPages","setTotalPages","fetchPosts","response","wp","apiFetch","path","Math","ceil","length","console","log","error","fetchRecentPosts","recentPosts","handleSearchChange","value","handlePostSelect","post","id","rendered","link","createElement","className","label","onChange","placeholder","map","key","isLink","onClick","tagName","content","allowedFormats","save","href"],"sourceRoot":""}